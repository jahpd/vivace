// Generated by CoffeeScript 1.4.0
(function() {
  var keyEvents;

  Vivace.keyEvents = keyEvents = {
    keys: {
      enter: {
        ref: 13,
        val: false
      },
      command: {
        ref: 91,
        val: false
      },
      point: {
        ref: 190,
        val: false
      }
    },
    run: function(c, e, p, lastVoices) {
      if (c && e) {
        return $.each(lastVoices, function(i, voiceRef) {
          return Vivace.update(voiceRef._name, function(nextbeat) {
            console.log('playing ' + voiceRef._name);
            return console.log('next beat will be in ' + nextbeat);
          });
        });
      }
    }
  };

  window.Vivace.keyboard = {
    runvoices: function(c, e, p) {
      return keyEvents.run(c, e, p, Vivace.lastVoices);
    },
    onkeyup: function(e) {
      if (e.which === keyEvents.keys.command.ref) {
        keyEvents.keys.command.val = false;
      }
      if (e.which === keyEvents.keys.enter.ref) {
        keyEvents.keys.enter.val = false;
      }
      if (e.which === keyEvents.keys.point.ref) {
        return keyEvents.keys.point.val = false;
      }
    },
    onkeydown: function(e) {
      if (e.which === keyEvents.keys.command.ref) {
        keyEvents.keys.command.val = true;
      }
      if (e.which === keyEvents.keys.enter.ref) {
        keyEvents.keys.enter.val = true;
      }
      if (e.which === keyEvents.keys.point.ref) {
        keyEvents.keys.point.val = true;
      }
      return Vivace.keyboard.runvoices(keyEvents.keys.command.val, keyEvents.keys.enter.val, keyEvents.keys.point.val);
    },
    create: function(callback) {
      document.onkeydown = Vivace.keyboard.onkeyup;
      document.onkeydown = Vivace.keyboard.onkeydown;
      return callback(Vivace.keyEvents.keys);
    }
  };

}).call(this);
