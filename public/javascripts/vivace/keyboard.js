// Generated by CoffeeScript 1.4.0
(function() {
  var LINUX, OSX, WINDOWS, keyEvents;

  OSX = {
    enter: 13,
    command: 91,
    point: 190
  };

  LINUX = {};

  WINDOWS = {};

  Vivace.keyEvents = keyEvents = {
    keys: {
      enter: {
        ref: OSX.enter,
        val: false
      },
      ctrl: {
        ref: OSX.command,
        val: false
      },
      point: {
        ref: OSX.point,
        val: false
      }
    },
    run: function(c, e, p, lastVoices) {
      if (c && e) {
        return $.each(lastVoices, function(i, voiceRef) {
          return Vivace.update(voiceRef._name, function(nextbeat) {
            console.log('playing ' + voiceRef._name);
            return console.log('next beat will be in ' + nextbeat);
          });
        });
      }
    }
  };

  window.Vivace.keyboard = {
    runvoices: function(c, e, p) {
      return keyEvents.run(c, e, p, Vivace.lastVoices);
    },
    onkeyup: function(e) {
      if (e.which === keyEvents.keys.ctrl.ref) {
        keyEvents.keys.ctrl.val = false;
      }
      if (e.which === keyEvents.keys.enter.ref) {
        keyEvents.keys.enter.val = false;
      }
      if (e.which === keyEvents.keys.point.ref) {
        return keyEvents.keys.point.val = false;
      }
    },
    onkeydown: function(e) {
      if (e.which === keyEvents.keys.ctrl.ref) {
        keyEvents.keys.ctrl.val = true;
      }
      if (e.which === keyEvents.keys.enter.ref) {
        keyEvents.keys.enter.val = true;
      }
      if (e.which === keyEvents.keys.point.ref) {
        keyEvents.keys.point.val = true;
      }
      return Vivace.keyboard.runvoices(keyEvents.keys.ctrl.val, keyEvents.keys.enter.val, keyEvents.keys.point.val);
    },
    create: function(callback) {
      document.onkeydown = Vivace.keyboard.onkeyup;
      document.onkeydown = Vivace.keyboard.onkeydown;
      if (callback) {
        return callback(Vivace.keyEvents.keys);
      }
    }
  };

}).call(this);
